<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Venmo Automatic Verification</title>

    <!-- Bootstrap core CSS -->
    <link href="../static/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="../static/css/starter-template.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="../../assets/js/ie-emulation-modes-warning.js"></script>
  
  <link rel="stylesheet" href="http://www.highcharts.com/joomla/media/templates/highsoft_2015/css/bootstrap.min.css" type="text/css" />
  <script src="http://www.highcharts.com/joomla/media/com_demo/js/highslide-full.min.js" type="text/javascript"></script>
  <script src="http://www.highcharts.com/joomla/media/com_demo/js/highslide.config.min.js" type="text/javascript"></script>
  <script src="http://www.highcharts.com/lib/jquery-1.7.2.js" type="text/javascript"></script>
  <script src="http://www.highcharts.com/joomla/media/templates/highsoft_2015/js/bootstrap.js" type="text/javascript"></script>
  <script src="http://www.highcharts.com/joomla/media/templates/highsoft_2015/js/modernizr.js" type="text/javascript"></script>
  <script src="http://www.highcharts.com/joomla/media/templates/highsoft_2015/js/script.js" type="text/javascript"></script>
  <script src="http://www.highcharts.com/joomla/media/templates/highsoft_2015/js/jquery.appear.min.js" type="text/javascript"></script>
  
    <script type="text/javascript">

    var $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
    jQuery.noConflict();
    var example = 'dynamic-update',
    theme = 'dark-unica';

    (function($){ // encapsulate jQuery
    $(function () {
        $(document).ready(function () {
            // Highcharts options
            Highcharts.setOptions({
                global: {
                    useUTC: false
                }
            });
            $('#container').highcharts({
                chart: {
                    type: 'spline',
                    //animation: Highcharts.svg, // don't animate in old IE
                    animation: {
                        //duration: 500,
                        easing: 'easeOutBounce'
                    },
                    marginRight: 10,
                    events: {
                        load: function () {
                        }
                    }
                },
                title: {
                    text: 'Transactions statistics'
                },
                xAxis: {
                    type: 'datetime',
                    tickPixelInterval: 150
                },
                yAxis: {
                    min: 0,
                    title: {
                        text: 'Transactions per second'
                    },
                    plotLines: [{
                        value: 0,
                        width: 1,
                        color: '#808080'
                    }]
                },
                tooltip: {
                    formatter: function () {
                        return '<b>' + this.series.name + '</b><br/>' +
                            Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br/>' +
                            Highcharts.numberFormat(this.y, 2);
                    }
                },
                legend: {
                    enabled: true,
            itemStyle: {
                font: '40 px'
            }
                },
                exporting: {
                    enabled: false
                },
                series: [
                {
                    data: [],
                    name: 'All transactions',
                    color: '#202adb',
                    dashStyle: 'longdash'
                },
                {
                    data: [],
                    name: 'Automatically verified transactions',
                    color: '#15dbc7'
                }]
            });
        });
    });
      $(function() {
        // This function takes care of loading content from the backend
        // and inserts it into the chart data structure
        var timer = 0;
        var submit_form = function() {
          // If called directly from UI, clear existing timer
          if(timer) {
            clearTimeout(timer);
            timer = 0;
          }
          // Get data from views.py
          $.getJSON($SCRIPT_ROOT + '/statistics', {
            currKey: $('select[id="currKey"]').val()
          }, function(data) {
            // Update chart
            var chart = $("#container").highcharts();
            var all_t = [];
            var av_t = [];
            for(var ii = 0; ii < data.all_t.length; ii++) {
              var couplet = data.all_t[ii];
              all_t.push([couplet[0]*1000, couplet[1]]);
            }
            for(var ii = 0; ii < data.av_t.length; ii++) {
              var couplet = data.av_t[ii];
              av_t.push([couplet[0]*1000, couplet[1]]);
            }
            chart.series[0].setData(all_t, false, true, true);
            chart.series[1].setData(av_t, false, true, true);
            chart.redraw();
          });
          // Restart timer to keep updating periodically.
          timer = setTimeout(submit_form, 1000);
        };
        $('a#calculate').bind('click', submit_form);
        $('input[type=text]').bind('keydown', function(e) {
          if (e.keyCode == 13) {
            submit_form();
          }
        });
        // Initial start of time, make it wait for 1 second to allow highcharts to load
        setTimeout(submit_form, 1000);
      });
    })(jQuery);
    </script>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300,700" rel="stylesheet" type="text/css">
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900" rel="stylesheet" type="text/css">
	<meta name="msapplication-TileColor" content="#2b5797">
	<meta name="msapplication-TileImage" content="http://www.highcharts.com/mstile-144x144.png">

	<script src="http://www.highcharts.com/joomla/js/covervid/covervid.js" type="text/javascript"></script>
	<script src="http://www.highcharts.com/joomla/js/covervid/fullscreen.js" type="text/javascript"></script>
</head>
<body >
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand">VAV</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="/stat">Statistics</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    <div align="center" class="container" >
        <div align="center" class="starter-template">
            <div align="center" class="col-lg-9 col-md-9 col-sm-9 col-xs-12 sidebar-eq demo">
                <script src="https://code.highcharts.com/highcharts.js"></script>
                <script src="https://code.highcharts.com/modules/exporting.js"></script>
                <!-- Container that holds the chart //-->
                <div align=center id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
                <div class="clearfix"></div>

            </div>
            <br />
    </div>

    </div>
        <div align=center class="starter-template">
         <h6 style="text-align:center">(c) 2017, Mariia Danilenko <br> Insight Data Engineering Program </h6>
        </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="../static/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>


